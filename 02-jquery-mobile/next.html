<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Globant :: Bootcamp :: 2nd Topic</title>
    <script src="jquery.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="jquerymobile.js"></script>
    <style>
        #movie
        {
        font-family:"Trebuchet MS", Arial, Helvetica, sans-serif;
        width:100%;
        border-collapse:collapse;
        }
        #movie td, #movie th 
        {
        font-size:1em;
        border:1px solid #98bf21;
        padding:3px 7px 2px 7px;
        }
        #movie th 
        {
        font-size:1.1em;
        text-align:left;
        padding-top:5px;
        padding-bottom:4px;
        background-color: yellowgreen;
        color:#ffffff;
        }
        #movie tr.alt td 
        {
        color:#000000;
        background-color:#EAF2D3;
        }
    </style>
  </head>
  <body style="text-align: center;">     
      <div data-role="page">
            <div data-role="header">
                <h1>Topic 2 | Items: 1-6</h1>
            </div>
            <div data-role="content" id="divMovies">
            </div>
            <div data-role="footer">
                <button id="back" data-transition="fade">Index</button>
                <button id="next" data-transition="fade">Next Points</button>                
                <br> 
              Globant - Bootcamp 2012
            </div>            
      </div>      
      
      <script>
            $(document).ready(function(){                        
                $.mobile.showPageLoadingMsg();
                $.mobile.showPageLoadingMsg(<img src='GreenLoader.gif'></img>);
                 getMovies(
                    function(jsonObj){
                        var movies = jsonObj.d.results;
                        var b = 0;
                        var table="";
                        table += '<table id="movie"><tr><th>Name</th><th>Year</th><th>Synopsis</th><th>Cover</th></tr>';
                        for(var i = 0 ; i < jsonObj.d.results.length; i++ ){
                            var res = movies[i];
                            if(b == 1){
                                table += '<tr class="alt"><td>'
                                +res.Name+'</td><td>'
                                +res.ReleaseYear+'</td><td>'
                                +res.Synopsis+'</td><td>'
                                +'<img src="'+res.BoxArt.SmallUrl+'"></img></td></tr>';
                                b = 0;
                            }else{
                               table += '<tr><td>'
                                +res.Name+'</td><td>'
                                +res.ReleaseYear+'</td><td>'
                                +res.Synopsis+'</td><td>'
                                +'<img src="'+res.BoxArt.SmallUrl+'"></img></td></tr>';
                                b = 1;
                            }                                
                        }
                        table +="</table>";
                        $('#divMovies').append(table);
                        $('#divMovies').style.opacity = 1.0;
                        $.mobile.hidePageLoadingMsg();
                    }
                   
                  );
 
                      
                  $(document).keydown(function(event) {
                    if (event.keyCode == '27') {
                       $.mobile.hidePageLoadingMsg();
                     }
                  });    
                      
            });
            
            function getMovies(callback){
                $.ajax({
                    type: 'GET',
                    url: "http://bootcamp.aws.af.cm/movies",
                    dataType: 'json',
                    crossDomain: true,
                    success: function (data) 
                    {                           
                        callback(data);
                    },
                    error: function failed (data) {
                      alert("Error: "+data.text,false);
                    }
                   });
            }
            $('#next').bind("click", function(){ 
                $(window.location).attr('href', 'multipage.html');
            })
             $('#back').bind("click", function(){ 
                $(window.location).attr('href', 'index.html');
            })
            
                
            </script>             
    </body>
    
</html>