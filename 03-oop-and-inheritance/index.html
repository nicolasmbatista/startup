<html>
	<head>
		 <script src="Movie.js"></script>
		 <script src="jquery.js"></script>
	</head>
	<body>
	<body>
	<script>
	function getMovies(callback){
                $.ajax({
                    type: 'GET',
                    url: "http://bootcamp.aws.af.cm/movies",
                    dataType: 'json',
                    crossDomain: true,
                    success: function (data) 
                    {                           
                        callback(data);
                    },
                    error: function failed (data) {
                      alert("Error: "+data.text,false);
                    }
                   });
            }

        
		$(document).ready(function(){ 
			var favMovies = [];
        	var movieObserver = new MovieObserver();
			 getMovies(
                    function(jsonObj){                        
                        movies = jsonObj.d.results;                      
                        for(var i = 0 ; i < 10; i++ ){
                            var res = movies[i];
                            var newMovie = new Movie();
                            newMovie.setAttribute('name',res.Name);
                            newMovie.setAttribute('year',res.ReleaseYear);
                            newMovie.setAttribute('synopsis',res.Synopsis);
                            newMovie.addObserver(movieObserver);
                            favMovies.push(newMovie);
                        }
                        	
                    	favMovies[5].play();
                    	favMovies[4].stop();
                    	//favMovies[7].like(); //Doesn't have this function

                        //extend works if Movie isn't a Module (unncomment Movie.js)
                        extend(Movie.prototype,Social);
                        //augment(Movie.prototype,Social);
                        favMovies[0].like(); //Now it does
                        favMovies[1].share('Eminem');

                    }
                    
                  );
            });
            

        //DownloadableMovie    
        function DownloadableMovie(){}

        //Inherits from Movie
		DownloadableMovie.prototype = new Movie();

		//We add some functionality 
		DownloadableMovie.prototype.download = function (){
			console.log('Donwloading '+ this.getAttribute('name') );
		}

		//To test the DownloadableMovie:

		/*
			var myD = new DownloadableMovie();
			myD.setAttribute('name','asd');
			myD.download();
		*/



        //Movie is NOT a Module
        		
        function extend(destination, source) {
            debugger;
		  for (var k in source) {
		    if (source.hasOwnProperty(k)) {
		      destination[k] = source[k];
		    }
		  }
		  return destination; 
		}

        function augment( receivingClass, givingClass ) {

            for ( var methodName in givingClass.prototype ) {

                // check to make sure the receiving class doesn't 
                // have a method of the same name as the one currently 
                // being processed 
                if ( !Object.hasOwnProperty(receivingClass.prototype, methodName) ) {
                    receivingClass.prototype[methodName] = givingClass.prototype[methodName];
                }

                // Alternatively:
                // if ( !receivingClass.prototype[methodName] ) {
                //  receivingClass.prototype[methodName] = givingClass.prototype[methodName];
                // }
            }
            
        }
        



		//In this case, we want to extend our Movie class with anotherone call Social
		var Social = {
		  share: function(friendName) {
		    console.log('Sharing ' + this.getAttribute('name') + ' with ' + friendName);
		  },
		  like: function() {
		    console.log('You like ' + this.getAttribute('name'));
		  }
		};    

		//To test the mixin:

		/*
			extend(Movie.prototype,Social);
			var myMovie = new Movie();
			myMovie.setAttribute('name','myName');
			myMovie.likE();
			myMovie.share('My Best friend');
		*/

		//Actor Class

        


	</script>
</html>